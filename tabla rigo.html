<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Altar de Día de Muertos con flores de cempasúchil</title>
<style>
  html,body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    background: linear-gradient(#0b1020, #13213a 60%);
    font-family: monospace;
    color: #fff;
  }

  /* Canvas del efecto */
  canvas {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    display: block;
    z-index: 1;
    pointer-events: none;
  }

  /* Contenedor del altar */
  .contenido {
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100%;
  }

  button {
    padding: 10px 20px;
    font-size: 18px;
    background-color: #ff6600;
    color: white;
    border: none;
    cursor: pointer;
    margin-bottom: 20px;
    box-shadow:
      inset -4px -4px 0px 0px #aa4400,
      inset 4px 4px 0px 0px #ffaa55;
  }
  button:hover { background-color: #ff8533; }

  .pixel-art-grid {
    display: grid;
    grid-template-columns: repeat(20, 1fr);
    grid-template-rows: repeat(20, 1fr);
    width: 400px;
    height: 400px;
    border: 4px solid white;
    box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
  }

  .pixel {
    width: 100%;
    height: 100%;
    border: 0.5px solid rgba(0, 0, 0, 0.1);
    box-sizing: border-box;
  }

  /* Colores del altar */
  .naranja { background-color: #ff7b00; }
  .morado { background-color: #a020f0; }
  .amarillo { background-color: #fff200; }
  .rojo { background-color: #ff0000; }
  .verde { background-color: #00a000; }
  .azul { background-color: #00aaff; }+
  .gris { background-color: #555555; }
  .negro { background-color: #1a1a1a; }
  .rosa {background-color: #FF00FF;}
  .blanco {background-color: #FFFFFF;}
</style>
</head>
<body>

<!-- Canvas del efecto de pétalos -->
<canvas id="c"></canvas>

<!-- Contenido principal -->
<div class="contenido">
  <button onclick="mostrarPixelArt()">Mostrar Altar</button>
  <div id="pixelArtContainer" class="pixel-art-grid">
    <p style="grid-column:1/-1;grid-row:1/-1;display:flex;align-items:center;justify-content:center;text-align:center;">Presiona el botón para ver el altar.</p>
  </div>
</div>

<script>
/* === PIXEL ART DEL ALTAR === */
const altar = [
  "vvvvvvvvnnnnnnnvvvvvvvv",
  "vvvvvvnnnnnnnnnnnvvvvvv",
  "vvvvnnnnnnnnnnnnnnvvvv",
  "vvvnnnnrvfvdvgvnnnnnvvv",
  "nnnnrvfvdvgvnnnnnvvvvvv",
  "vnnvvvvvvvvvvvvnnvvvvvv",
  "vnnnvvvvvvvvvvnnnvvvvvv",
  "vvnnnnvvvvnnnnnnvvvvvvv",
  "vvvvmmdrbbdrmmvvvvvvvvv",
  "vvvvmmrrbbrrmmvvvvvvvvv",
  "vvmmmmdrffdrmmmmvvvvvvv",
  "vmmmmmrrffrrmmmmmvvvvvv",
  "vmmddmmffffmmddmmvvvvvv",
  "vmmddmmffffmmddmmvvvvvv",
  "vvvddmmffffmmddvvvvvvvv",
  "vvvvddmmffffmmvvvvvvvvv",
  "vvvvvvmmmmmmvvvvvvvvvvv",
  "vvvvvvvddmmddvvvvvvvvvv",
  "vvvvvvvddddddvvvvvvvvvv",
  "vvvvvvvvvvvvvvvvvvvvvvv"
];

const colorMap = {
  v: "negro",
  n: "naranja",
  m: "morado",
  d: "amarillo",
  r: "rojo",
  f: "azul",
  g: "verde",
  b: "gris",
  R: "rosa",
  b: "blanco"
};

function mostrarPixelArt() {
  const container = document.getElementById("pixelArtContainer");
  container.innerHTML = "";
  altar.forEach(row => {
    row.split("").forEach(pixel => {
      const div = document.createElement("div");
      div.classList.add("pixel", colorMap[pixel] || "vacio");
      container.appendChild(div);
    });
  });
}

/* === EFECTO DE FLORES DE CEMPASÚCHIL === */
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d', {alpha: true});
let W = canvas.width = innerWidth;
let H = canvas.height = innerHeight;

window.addEventListener('resize', () => {
  W = canvas.width = innerWidth;
  H = canvas.height = innerHeight;
});

// Flor SVG como imagen
const petalSVG = `
<svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 100 100">
  <defs>
    <radialGradient id="g" cx="40%" cy="30%" r="70%">
      <stop offset="0%" stop-color="#ffd54a"/>
      <stop offset="55%" stop-color="#ffab00"/>
      <stop offset="100%" stop-color="#ff6f00"/>
    </radialGradient>
    <filter id="s" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="0.8" result="b"/>
      <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>
  <g filter="url(#s)" transform="translate(10,10)">
    <path d="M30 10 C25 18 18 22 14 36 C12 46 22 62 38 70 C60 80 68 72 74 60 C82 44 78 28 60 18 C50 12 36 8 30 10 Z" fill="url(#g)"/>
  </g>
</svg>`;
const petalImg = new Image();
petalImg.src = 'data:image/svg+xml;utf8,' + encodeURIComponent(petalSVG);

class Petal {
  constructor() { this.reset(true); }
  reset(initial=false) {
    this.x = Math.random() * W;
    this.y = initial ? Math.random() * -H : -50;
    this.vy = 0.6 + Math.random() * 2.2;
    this.vx = (Math.random() - 0.5) * 0.6;
    this.swayAmp = 20 + Math.random() * 40;
    this.swayFreq = 0.0015 + Math.random() * 0.0035;
    this.swayPhase = Math.random() * Math.PI * 2;
    this.rot = Math.random() * Math.PI * 2;
    this.rotSpeed = (Math.random() - 0.5) * 0.02;
    this.scale = 0.35 + Math.random() * 0.85;
    this.alpha = 0.7 + Math.random() * 0.35;
  }
  update(dt) {
    this.vy += 0.0006 * dt;
    this.y += this.vy * dt * 0.06;
    this.x += Math.sin(this.y * this.swayFreq + this.swayPhase) * (this.swayAmp * 0.001) * dt + this.vx * dt * 0.06;
    this.rot += this.rotSpeed * dt;
    if (this.y > H + 60) this.reset();
  }
  draw(ctx) {
    ctx.save();
    ctx.globalAlpha = this.alpha;
    ctx.translate(this.x, this.y);
    ctx.rotate(this.rot);
    ctx.scale(this.scale, this.scale);
    ctx.drawImage(petalImg, -40, -40, 80, 80);
    ctx.restore();
  }
}

const petals = [];
for (let i=0; i<80; i++) petals.push(new Petal());

let last = performance.now();
function loop(now) {
  const dt = now - last;
  last = now;
  ctx.clearRect(0,0,W,H);
  for (const p of petals) { p.update(dt); p.draw(ctx); }
  requestAnimationFrame(loop);
}
petalImg.onload = () => requestAnimationFrame(loop);
</script>
</body>
</html>